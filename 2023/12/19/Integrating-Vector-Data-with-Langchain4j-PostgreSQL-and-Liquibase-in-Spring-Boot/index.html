<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.samzhu.dev","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.18.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="This article dives into the integration of Langchain4j, PostgreSQL, and Liquibase within a Spring Boot environment, tailored specifically for Java developers. Langchain4j, a framework designed for eff">
<meta property="og:type" content="article">
<meta property="og:title" content="Integrating Vector Data with Langchain4j PostgreSQL and Liquibase in Spring Boot">
<meta property="og:url" content="https://blog.samzhu.dev/2023/12/19/Integrating-Vector-Data-with-Langchain4j-PostgreSQL-and-Liquibase-in-Spring-Boot/index.html">
<meta property="og:site_name" content="Sam&#39;s programming note">
<meta property="og:description" content="This article dives into the integration of Langchain4j, PostgreSQL, and Liquibase within a Spring Boot environment, tailored specifically for Java developers. Langchain4j, a framework designed for eff">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-12-19T15:41:30.000Z">
<meta property="article:modified_time" content="2025-07-24T15:41:45.581Z">
<meta property="article:author" content="Sam Zhu">
<meta property="article:tag" content="Spring">
<meta property="article:tag" content="Langchain4j">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@samzhu0318">


<link rel="canonical" href="https://blog.samzhu.dev/2023/12/19/Integrating-Vector-Data-with-Langchain4j-PostgreSQL-and-Liquibase-in-Spring-Boot/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://blog.samzhu.dev/2023/12/19/Integrating-Vector-Data-with-Langchain4j-PostgreSQL-and-Liquibase-in-Spring-Boot/","path":"2023/12/19/Integrating-Vector-Data-with-Langchain4j-PostgreSQL-and-Liquibase-in-Spring-Boot/","title":"Integrating Vector Data with Langchain4j PostgreSQL and Liquibase in Spring Boot"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Integrating Vector Data with Langchain4j PostgreSQL and Liquibase in Spring Boot | Sam's programming note</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CFLHEYEETG"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-CFLHEYEETG","only_pageview":false}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>







<meta name="google-adsense-account" content="ca-pub-5880479202699914">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5880479202699914"
     crossorigin="anonymous"></script>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Sam's programming note</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Setting-Up-the-Project-Environment"><span class="nav-number">1.</span> <span class="nav-text">Setting Up the Project Environment</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Liquibase-Configuration-Explained"><span class="nav-number">2.</span> <span class="nav-text">Liquibase Configuration Explained</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Langchain4j-and-Its-Role-in-Vector-Data-Management"><span class="nav-number">3.</span> <span class="nav-text">Langchain4j and Its Role in Vector Data Management</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Deep-Dive-into-the-Code-SpringJdbcPgVectorEmbeddingStore-Class"><span class="nav-number">4.</span> <span class="nav-text">Deep Dive into the Code: SpringJdbcPgVectorEmbeddingStore Class</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Leveraging-Liquibase-for-Database-Version-Control"><span class="nav-number">5.</span> <span class="nav-text">Leveraging Liquibase for Database Version Control</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Sam Zhu"
      src="https://i.imgur.com/eLloI4N.png">
  <p class="site-author-name" itemprop="name">Sam Zhu</p>
  <div class="site-description" itemprop="description">Hello, I'm Sam, a tech-savvy blogger with a passion for programming. I share insights on programming, cloud computing, and more, including topics like SpringBoot, SpringCloud, GCP. My blog aims to assist both newcomers and professionals in these fields.</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">59</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">74</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/samzhu" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;samzhu" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/samzhu0318" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;samzhu0318" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.samzhu.dev/2023/12/19/Integrating-Vector-Data-with-Langchain4j-PostgreSQL-and-Liquibase-in-Spring-Boot/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://i.imgur.com/eLloI4N.png">
      <meta itemprop="name" content="Sam Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sam's programming note">
      <meta itemprop="description" content="Hello, I'm Sam, a tech-savvy blogger with a passion for programming. I share insights on programming, cloud computing, and more, including topics like SpringBoot, SpringCloud, GCP. My blog aims to assist both newcomers and professionals in these fields.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Integrating Vector Data with Langchain4j PostgreSQL and Liquibase in Spring Boot | Sam's programming note">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Integrating Vector Data with Langchain4j PostgreSQL and Liquibase in Spring Boot
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-12-19 23:41:30" itemprop="dateCreated datePublished" datetime="2023-12-19T23:41:30+08:00">2023-12-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-07-24 23:41:45" itemprop="dateModified" datetime="2025-07-24T23:41:45+08:00">2025-07-24</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>This article dives into the integration of Langchain4j, PostgreSQL, and Liquibase within a Spring Boot environment, tailored specifically for Java developers. Langchain4j, a framework designed for efficient vector data management, when combined with PostgreSQL’s robust database capabilities and Liquibase’s schema version control, creates a powerful ecosystem. This guide will walk you through setting up these integrations, detailing the configurations and code necessary to manage complex vector data. By understanding and implementing these integrations, developers can significantly enhance the performance and scalability of their data-driven applications, paving the way for advanced analytics and machine learning operations.</p>
<span id="more"></span>

<h2 id="Setting-Up-the-Project-Environment"><a href="#Setting-Up-the-Project-Environment" class="headerlink" title="Setting Up the Project Environment"></a>Setting Up the Project Environment</h2><p>Initiating a Spring Boot project with Gradle is the first step in our journey to integrate Langchain4j, PostgreSQL, and Liquibase. To start, create a new Spring Boot project, either through Spring Initializr or manually setting up a Gradle project. Ensure your <code>build.gradle</code> file includes the necessary dependencies for Spring Boot and any other tools you plan to use.</p>
<p>Next, incorporate the Liquibase dependency into your Gradle build script. Adding <code>implementation &#39;org.liquibase:liquibase-core&#39;</code> to your <code>dependencies</code> block in <code>build.gradle</code> integrates Liquibase into your project. This setup is crucial for managing database migrations and schema changes, allowing you to version control your database alongside your application code seamlessly.</p>
<p>This foundational setup lays the groundwork for a robust application, capable of handling complex data management tasks with ease and efficiency.</p>
<p>Incorporating the provided Liquibase YAML configurations into the article gives us a complete picture of the database schema management process. Here’s a revised section that integrates these details:</p>
<h2 id="Liquibase-Configuration-Explained"><a href="#Liquibase-Configuration-Explained" class="headerlink" title="Liquibase Configuration Explained"></a>Liquibase Configuration Explained</h2><p>Liquibase, integrated into a Spring Boot environment, excels in managing and applying database schema changes. The YAML configurations provided play a critical role in this process:</p>
<ol>
<li><strong>Master Changelog Configuration (<code>db.changelog-master.yaml</code>):</strong> This file acts as the root for all schema change logs. It includes references to other YAML files that define specific database changes. For example:</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">databaseChangeLog:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">include:</span></span><br><span class="line">      <span class="attr">file:</span> <span class="string">history/001-enable-extension.yaml</span></span><br><span class="line">      <span class="attr">relativeToChangelogFile:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">description:</span> <span class="string">enable</span> <span class="string">vector</span> <span class="string">extension</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">include:</span></span><br><span class="line">      <span class="attr">file:</span> <span class="string">history/002-schema-init.yaml</span></span><br><span class="line">      <span class="attr">relativeToChangelogFile:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">description:</span> <span class="string">schema</span> <span class="string">init</span></span><br></pre></td></tr></table></figure>

<p>It references two critical changes: enabling the vector extension and initializing the schema.</p>
<ol start="2">
<li><strong>Enabling Vector Extension (<code>001-enable-extension.yaml</code>):</strong> This file contains a changeSet that creates a vector extension if it doesn’t exist. This is essential for working with vector data types in PostgreSQL.</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">databaseChangeLog:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">changeSet:</span></span><br><span class="line">    <span class="attr">id:</span> <span class="number">1700794119845</span><span class="number">-1</span></span><br><span class="line">    <span class="attr">author:</span> <span class="string">samzhu</span> <span class="string">(generated)</span></span><br><span class="line">    <span class="attr">changes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">sql:</span> </span><br><span class="line">        <span class="attr">sql:</span> <span class="string">CREATE</span> <span class="string">extension</span> <span class="string">IF</span> <span class="string">NOT</span> <span class="string">EXISTS</span> <span class="string">vector;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li><strong>Schema Initialization (<code>002-schema-init.yaml</code>):</strong> This file outlines the initial schema for the <code>dataset_embedding</code> table, detailing columns for storing vector data, text, metadata, and other relevant information.</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">databaseChangeLog:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">changeSet:</span></span><br><span class="line">    <span class="attr">id:</span> <span class="number">1700794119845</span><span class="number">-2</span></span><br><span class="line">    <span class="attr">author:</span> <span class="string">samzhu</span> <span class="string">(generated)</span></span><br><span class="line">    <span class="attr">changes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">createTable:</span></span><br><span class="line">        <span class="attr">columns:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">column:</span></span><br><span class="line">            <span class="attr">constraints:</span></span><br><span class="line">              <span class="attr">nullable:</span> <span class="literal">false</span></span><br><span class="line">              <span class="attr">primaryKey:</span> <span class="literal">true</span></span><br><span class="line">              <span class="attr">primaryKeyName:</span> <span class="string">pk_dataset_embedding_id</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">id</span></span><br><span class="line">            <span class="attr">remarks:</span> <span class="string">Unique</span> <span class="string">identifier</span> <span class="string">for</span> <span class="string">each</span> <span class="string">record,</span> <span class="string">using</span> <span class="string">UUID</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">VARCHAR(36)</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">column:</span></span><br><span class="line">            <span class="attr">constraints:</span></span><br><span class="line">              <span class="attr">nullable:</span> <span class="literal">false</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">dataset_id</span></span><br><span class="line">            <span class="attr">remarks:</span> <span class="string">Unique</span> <span class="string">identifier</span> <span class="string">for</span> <span class="string">the</span> <span class="string">dataset</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">VARCHAR(36)</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">column:</span></span><br><span class="line">            <span class="attr">constraints:</span></span><br><span class="line">              <span class="attr">nullable:</span> <span class="literal">false</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">file_name</span></span><br><span class="line">            <span class="attr">remarks:</span> <span class="string">Name</span> <span class="string">of</span> <span class="string">the</span> <span class="string">file</span> <span class="string">in</span> <span class="string">the</span> <span class="string">dataset</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">VARCHAR(60)</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">column:</span></span><br><span class="line">            <span class="attr">constraints:</span></span><br><span class="line">              <span class="attr">nullable:</span> <span class="literal">false</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">embedding_vector</span></span><br><span class="line">            <span class="attr">remarks:</span> <span class="string">Embedding</span> <span class="string">vector</span> <span class="string">of</span> <span class="string">the</span> <span class="string">file,</span> <span class="string">stored</span> <span class="string">using</span> <span class="string">the</span> <span class="string">vector</span> <span class="string">type</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">VECTOR(1536)</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">column:</span></span><br><span class="line">            <span class="attr">constraints:</span></span><br><span class="line">              <span class="attr">nullable:</span> <span class="literal">false</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">document_text</span></span><br><span class="line">            <span class="attr">remarks:</span> <span class="string">Document</span> <span class="string">text</span> <span class="string">corresponding</span> <span class="string">to</span> <span class="string">the</span> <span class="string">file</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">TEXT</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">column:</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">metadata</span></span><br><span class="line">            <span class="attr">remarks:</span> <span class="string">Stores</span> <span class="string">additional</span> <span class="string">metadata</span> <span class="string">related</span> <span class="string">to</span> <span class="string">the</span> <span class="string">file,</span> <span class="string">using</span> <span class="string">JSONB</span> <span class="string">format</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">JSONB</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">column:</span></span><br><span class="line">            <span class="attr">constraints:</span></span><br><span class="line">              <span class="attr">nullable:</span> <span class="literal">false</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">version_count</span></span><br><span class="line">            <span class="attr">remarks:</span> <span class="string">Count</span> <span class="string">of</span> <span class="string">file</span> <span class="string">versions</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">INTEGER</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">column:</span></span><br><span class="line">            <span class="attr">constraints:</span></span><br><span class="line">              <span class="attr">nullable:</span> <span class="literal">false</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">created_by</span></span><br><span class="line">            <span class="attr">remarks:</span> <span class="string">Username</span> <span class="string">of</span> <span class="string">the</span> <span class="string">user</span> <span class="string">who</span> <span class="string">created</span> <span class="string">the</span> <span class="string">record</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">VARCHAR(60)</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">column:</span></span><br><span class="line">            <span class="attr">constraints:</span></span><br><span class="line">              <span class="attr">nullable:</span> <span class="literal">false</span></span><br><span class="line">            <span class="attr">defaultValueComputed:</span> <span class="string">CURRENT_TIMESTAMP</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">creation_timestamp</span></span><br><span class="line">            <span class="attr">remarks:</span> <span class="string">Timestamp</span> <span class="string">of</span> <span class="string">record</span> <span class="string">creation,</span> <span class="string">using</span> <span class="string">TIMESTAMPTZ</span> <span class="string">type</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">TIMESTAMP</span> <span class="string">WITH</span> <span class="string">TIME</span> <span class="string">ZONE</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">column:</span></span><br><span class="line">            <span class="attr">constraints:</span></span><br><span class="line">              <span class="attr">nullable:</span> <span class="literal">false</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">modified_by</span></span><br><span class="line">            <span class="attr">remarks:</span> <span class="string">Username</span> <span class="string">of</span> <span class="string">the</span> <span class="string">user</span> <span class="string">who</span> <span class="string">last</span> <span class="string">modified</span> <span class="string">the</span> <span class="string">record</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">VARCHAR(60)</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">column:</span></span><br><span class="line">            <span class="attr">constraints:</span></span><br><span class="line">              <span class="attr">nullable:</span> <span class="literal">false</span></span><br><span class="line">            <span class="attr">defaultValueComputed:</span> <span class="string">CURRENT_TIMESTAMP</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">modification_timestamp</span></span><br><span class="line">            <span class="attr">remarks:</span> <span class="string">Timestamp</span> <span class="string">of</span> <span class="string">the</span> <span class="string">last</span> <span class="string">modification</span> <span class="string">of</span> <span class="string">the</span> <span class="string">record,</span> <span class="string">using</span> <span class="string">TIMESTAMPTZ</span> <span class="string">type</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">TIMESTAMP</span> <span class="string">WITH</span> <span class="string">TIME</span> <span class="string">ZONE</span></span><br><span class="line">        <span class="attr">remarks:</span> <span class="string">Used</span> <span class="string">to</span> <span class="string">store</span> <span class="string">embedding</span> <span class="string">vectors</span> <span class="string">of</span> <span class="string">the</span> <span class="string">dataset,</span> <span class="string">including</span> <span class="string">embedding</span> <span class="string">vectors</span> <span class="string">of</span> <span class="string">files,</span> <span class="string">document</span> <span class="string">text,</span> <span class="string">and</span> <span class="string">related</span> <span class="string">metadata</span></span><br><span class="line">        <span class="attr">tableName:</span> <span class="string">dataset_embedding</span></span><br></pre></td></tr></table></figure>

<p>These configurations, combined with the <code>application.yaml</code> setup for database connectivity, complete the Liquibase setup in your Spring Boot project. They ensure that your database schema is managed efficiently, maintaining consistency and reliability in your application’s data layer.</p>
<h2 id="Langchain4j-and-Its-Role-in-Vector-Data-Management"><a href="#Langchain4j-and-Its-Role-in-Vector-Data-Management" class="headerlink" title="Langchain4j and Its Role in Vector Data Management"></a>Langchain4j and Its Role in Vector Data Management</h2><p>Langchain4j is a Java-based framework that significantly enhances Java applications by integrating advanced AI and Large Language Model (LLM) capabilities. It offers a flexible architecture that allows easy integration and swapping of various components like LLM providers and embedding store providers. Key features include data ingestion, autonomous agents, prompt templates, context-aware memory, structured outputs, and AI services. This makes Langchain4j ideal for managing vector data and complex AI functionalities within Java environments, especially in applications that require intelligent data processing and interaction. For more detailed insights, Langchain4j’s GitHub page is a valuable resource. <a target="_blank" rel="noopener" href="https://github.com/langchain4j/langchain4j">Explore Langchain4j on GitHub</a>.</p>
<h2 id="Deep-Dive-into-the-Code-SpringJdbcPgVectorEmbeddingStore-Class"><a href="#Deep-Dive-into-the-Code-SpringJdbcPgVectorEmbeddingStore-Class" class="headerlink" title="Deep Dive into the Code: SpringJdbcPgVectorEmbeddingStore Class"></a>Deep Dive into the Code: SpringJdbcPgVectorEmbeddingStore Class</h2><p>In the <code>SpringJdbcPgVectorEmbeddingStore</code> class, we explore functionalities essential for embedding management in a Java-Spring environment with PostgreSQL:</p>
<ol>
<li><p><strong>Add Operations:</strong> The <code>add</code> methods, crucial for inserting new embeddings, use <code>MapSqlParameterSource</code> for SQL parameter handling. This demonstrates how to integrate complex object mapping and database interactions in Spring.</p>
</li>
<li><p><strong>Find Relevant Embeddings:</strong> The <code>findRelevant</code> method showcases advanced querying techniques using PostgreSQL’s vector operations, crucial for fetching the most relevant embeddings based on a reference vector.</p>
</li>
<li><p><strong>Delete Operations:</strong> The <code>deleteEmbeddingByFilename</code> method highlights data management capabilities, allowing deletion of embeddings based on specific criteria.</p>
</li>
</ol>
<p>The class encapsulates best practices in handling vector data within a Java-Spring context, providing a practical example of efficient database operations and vector data management.</p>
<p>For a complete understanding, here is the full code of the <code>SpringJdbcPgVectorEmbeddingStore</code> class:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Optional;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.postgresql.util.PGobject;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.RowMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.namedparam.MapSqlParameterSource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.namedparam.SqlParameterSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.core.JsonProcessingException;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.core.type.TypeReference;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> com.pgvector.PGvector;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> dev.langchain4j.data.document.Metadata;</span><br><span class="line"><span class="keyword">import</span> dev.langchain4j.data.embedding.Embedding;</span><br><span class="line"><span class="keyword">import</span> dev.langchain4j.data.segment.TextSegment;</span><br><span class="line"><span class="keyword">import</span> dev.langchain4j.store.embedding.EmbeddingMatch;</span><br><span class="line"><span class="keyword">import</span> dev.langchain4j.store.embedding.EmbeddingStore;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * A store for managing embeddings and text segments using PostgreSQL and pgvector.</span></span><br><span class="line"><span class="comment"> * It provides functionality to add, retrieve, and delete embeddings and their associated text segments.</span></span><br><span class="line"><span class="comment"> * Ref:</span></span><br><span class="line"><span class="comment"> * https://github.com/langchain4j/langchain4j/blob/main/langchain4j-pgvector/src/main/java/dev/langchain4j/store/embedding/pgvector/PgVectorEmbeddingStore.java</span></span><br><span class="line"><span class="comment"> * https://tembo.io/blog/vector-indexes-in-pgvector/</span></span><br><span class="line"><span class="comment"> * https://supabase.com/blog/increase-performance-pgvector-hnsw</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringJdbcPgVectorEmbeddingStore</span> <span class="keyword">implements</span> <span class="title class_">EmbeddingStore</span>&lt;TextSegment&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SQL_INSERT_EMBEDDING</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO dataset_embedding &quot;</span> +</span><br><span class="line">            <span class="string">&quot;(id, dataset_id, file_name, embedding_vector, document_text, metadata, version_count, created_by, creation_timestamp, modified_by, modification_timestamp) &quot;</span></span><br><span class="line">            + <span class="string">&quot;VALUES (:id, :datasetId, :fileName, :embeddingVector, :documentText, :metadata::jsonb, :versionCount, :createdBy, :creationTimestamp, :modifiedBy, :modificationTimestamp)&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SQL_DELETE_EMBEDDING_BY_FILENAME</span> <span class="operator">=</span> <span class="string">&quot;DELETE FROM dataset_embedding WHERE file_name = :fileName AND dataset_id = :datasetId&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SQL_FIND_RELEVANT</span> <span class="operator">=</span> <span class="string">&quot;WITH temp AS (&quot;</span> +</span><br><span class="line">            <span class="string">&quot;SELECT (2 - (embedding_vector &lt;=&gt; :embeddingVector)) / 2 AS score, id, embedding_vector, document_text, metadata &quot;</span></span><br><span class="line">            + <span class="string">&quot;FROM dataset_embedding WHERE dataset_id IN (:datasetIds)) &quot;</span></span><br><span class="line">            + <span class="string">&quot;SELECT * FROM temp WHERE score &gt;= :minScore ORDER BY score DESC LIMIT :maxResults&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ObjectMapper objectMapper;</span><br><span class="line">    <span class="keyword">private</span> NamedParameterJdbcTemplate jdbcTemplate;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; datasetIds;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Constructs a new PgVectorEmbeddingStore with multiple dataset identifiers.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> datasetIds   A list of dataset identifiers.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> jdbcTemplate The jdbcTemplate for database operations.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SpringJdbcPgVectorEmbeddingStore</span><span class="params">(List&lt;String&gt; datasetIds, NamedParameterJdbcTemplate jdbcTemplate)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.datasetIds = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(datasetIds);</span><br><span class="line">        <span class="built_in">this</span>.jdbcTemplate = jdbcTemplate;</span><br><span class="line">        <span class="built_in">this</span>.objectMapper = <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        log.debug(<span class="string">&quot;PgVectorEmbeddingStore initialized with dataset identifiers: &#123;&#125;&quot;</span>, datasetIds);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Constructs a new PgVectorEmbeddingStore with a single dataset identifier.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> datasetId    A single dataset identifier.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> jdbcTemplate The jdbcTemplate for database operations.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SpringJdbcPgVectorEmbeddingStore</span><span class="params">(String datasetId, NamedParameterJdbcTemplate jdbcTemplate)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(Collections.singletonList(datasetId), jdbcTemplate);</span><br><span class="line">        log.debug(<span class="string">&quot;PgVectorEmbeddingStore initialized with single dataset identifier: &#123;&#125;&quot;</span>, datasetId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">add</span><span class="params">(Embedding embedding)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;Adding a single embedding to the database&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> UUID.randomUUID().toString();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">MapSqlParameterSource</span> <span class="variable">params</span> <span class="operator">=</span> createSqlParameterSource(</span><br><span class="line">                    id,</span><br><span class="line">                    <span class="built_in">this</span>.datasetIds.get(<span class="number">0</span>),</span><br><span class="line">                    embedding,</span><br><span class="line">                    <span class="literal">null</span>);</span><br><span class="line">            jdbcTemplate.update(SQL_INSERT_EMBEDDING, params);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;Error processing JSON&quot;</span>, e);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">&quot;Added embedding with ID: &#123;&#125;&quot;</span>, id);</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(String id, Embedding embedding)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;Adding a single embedding with provided ID: &#123;&#125;&quot;</span>, id);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">MapSqlParameterSource</span> <span class="variable">params</span> <span class="operator">=</span> createSqlParameterSource(</span><br><span class="line">                    id,</span><br><span class="line">                    <span class="built_in">this</span>.datasetIds.get(<span class="number">0</span>),</span><br><span class="line">                    embedding,</span><br><span class="line">                    <span class="literal">null</span>);</span><br><span class="line">            jdbcTemplate.update(SQL_INSERT_EMBEDDING, params);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;Error processing JSON&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">&quot;Added embedding with ID: &#123;&#125;&quot;</span>, id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">add</span><span class="params">(Embedding embedding, TextSegment embedded)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;Adding an embedding with associated text segment to the database&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> UUID.randomUUID().toString();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">MapSqlParameterSource</span> <span class="variable">params</span> <span class="operator">=</span> createSqlParameterSource(</span><br><span class="line">                    id,</span><br><span class="line">                    <span class="built_in">this</span>.datasetIds.get(<span class="number">0</span>),</span><br><span class="line">                    embedding,</span><br><span class="line">                    embedded);</span><br><span class="line">            jdbcTemplate.update(SQL_INSERT_EMBEDDING, params);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;Error processing JSON&quot;</span>, e);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">&quot;Added embedding with ID: &#123;&#125;&quot;</span>, id);</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">addAll</span><span class="params">(List&lt;Embedding&gt; embeddings)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;Adding a list of embeddings to the database&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (embeddings.isEmpty()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;No embeddings to add.&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!hasSingleDatasetIdentifier()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;Operation requires a single dataset identifier.&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        List&lt;TextSegment&gt; textSegments = Collections.nCopies(embeddings.size(), <span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">return</span> addAll(embeddings, textSegments);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Adds a list of embeddings and their associated text segments to the database.</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> embeddings   The list of embeddings to add.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> textSegments The list of text segments associated with each embedding.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> A list of generated unique identifiers for the added embeddings.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">addAll</span><span class="params">(List&lt;Embedding&gt; embeddings, List&lt;TextSegment&gt; textSegments)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;Adding a list of embeddings and associated text segments to the database&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (embeddings.isEmpty() || textSegments.isEmpty()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;No embeddings or text segments to add.&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!hasSingleDatasetIdentifier()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;Operation requires a single dataset identifier.&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        List&lt;MapSqlParameterSource&gt; paramsForBatchInsert = prepareBatchInsertParams(embeddings, textSegments);</span><br><span class="line"></span><br><span class="line">        List&lt;String&gt; generatedIds = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (MapSqlParameterSource params : paramsForBatchInsert) &#123;</span><br><span class="line">            generatedIds.add(params.getValue(<span class="string">&quot;id&quot;</span>).toString());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        jdbcTemplate.batchUpdate(SQL_INSERT_EMBEDDING, paramsForBatchInsert.toArray(<span class="keyword">new</span> <span class="title class_">SqlParameterSource</span>[<span class="number">0</span>]));</span><br><span class="line">        log.info(<span class="string">&quot;Batch insert of embeddings and text segments completed&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> generatedIds;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Finds embeddings that are most relevant (closest in space) to a provided</span></span><br><span class="line"><span class="comment">     * reference embedding.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> referenceEmbedding The embedding to use as a reference. The returned</span></span><br><span class="line"><span class="comment">     *                           embeddings should be relevant (closest) to this.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> maxResults         The maximum number of embeddings to return.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> minScore           The minimum relevance score, ranging from 0 to 1</span></span><br><span class="line"><span class="comment">     *                           (inclusive).</span></span><br><span class="line"><span class="comment">     *                           Only embeddings with a score of this value or</span></span><br><span class="line"><span class="comment">     *                           higher will be returned.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> A list of EmbeddingMatch objects. Each EmbeddingMatch includes a</span></span><br><span class="line"><span class="comment">     *         relevance score (derived from cosine distance), ranging from 0 (not</span></span><br><span class="line"><span class="comment">     *         relevant) to 1 (highly relevant).</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;EmbeddingMatch&lt;TextSegment&gt;&gt; <span class="title function_">findRelevant</span><span class="params">(Embedding referenceEmbedding, <span class="type">int</span> maxResults,</span></span><br><span class="line"><span class="params">            <span class="type">double</span> minScore)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;Finding embeddings relevant to a given reference embedding&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">MapSqlParameterSource</span> <span class="variable">parameters</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MapSqlParameterSource</span>()</span><br><span class="line">                .addValue(<span class="string">&quot;embeddingVector&quot;</span>, <span class="keyword">new</span> <span class="title class_">PGvector</span>(referenceEmbedding.vector()))</span><br><span class="line">                .addValue(<span class="string">&quot;datasetIds&quot;</span>, <span class="built_in">this</span>.datasetIds)</span><br><span class="line">                .addValue(<span class="string">&quot;minScore&quot;</span>, minScore)</span><br><span class="line">                .addValue(<span class="string">&quot;maxResults&quot;</span>, maxResults);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> jdbcTemplate.query(SQL_FIND_RELEVANT, parameters, <span class="keyword">new</span> <span class="title class_">RowMapper</span>&lt;EmbeddingMatch&lt;TextSegment&gt;&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> EmbeddingMatch&lt;TextSegment&gt; <span class="title function_">mapRow</span><span class="params">(ResultSet rs, <span class="type">int</span> rowNum)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">                <span class="type">double</span> <span class="variable">score</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;score&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">embeddingId</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">                <span class="type">PGobject</span> <span class="variable">embeddingVectorObj</span> <span class="operator">=</span> (PGobject) rs.getObject(<span class="string">&quot;embedding_vector&quot;</span>);</span><br><span class="line">                <span class="type">PGvector</span> <span class="variable">vector</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PGvector</span>(embeddingVectorObj.getValue());</span><br><span class="line">                <span class="type">Embedding</span> <span class="variable">embedding</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Embedding</span>(vector.toArray());</span><br><span class="line">                <span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;document_text&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">metadataJson</span> <span class="operator">=</span> Optional.ofNullable(rs.getString(<span class="string">&quot;metadata&quot;</span>)).orElse(<span class="string">&quot;&#123;&#125;&quot;</span>);</span><br><span class="line">                Map&lt;String, String&gt; metadataMap;</span><br><span class="line">                Metadata metadata;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    metadataMap = objectMapper.readValue(metadataJson, <span class="keyword">new</span> <span class="title class_">TypeReference</span>&lt;Map&lt;String, String&gt;&gt;() &#123;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    metadata = <span class="keyword">new</span> <span class="title class_">Metadata</span>(metadataMap);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">                    log.error(<span class="string">&quot;Error processing JSON&quot;</span>, e);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="type">TextSegment</span> <span class="variable">textSegment</span> <span class="operator">=</span> text == <span class="literal">null</span> || text.isEmpty() ? <span class="literal">null</span> : TextSegment.from(text, metadata);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">EmbeddingMatch</span>&lt;&gt;(score, embeddingId, embedding, textSegment);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Deletes embeddings from the database based on filename.</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> filename The filename of the embeddings to be deleted.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteEmbeddingByFilename</span><span class="params">(String filename)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;Deleting embeddings from the database based on filename&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!hasSingleDatasetIdentifier()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;Operation requires a single dataset identifier.&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">MapSqlParameterSource</span> <span class="variable">params</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MapSqlParameterSource</span>()</span><br><span class="line">                .addValue(<span class="string">&quot;fileName&quot;</span>, filename)</span><br><span class="line">                .addValue(<span class="string">&quot;datasetId&quot;</span>, <span class="built_in">this</span>.datasetIds.get(<span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">        jdbcTemplate.update(SQL_DELETE_EMBEDDING_BY_FILENAME, params);</span><br><span class="line">        log.info(<span class="string">&quot;Embeddings with filename &#123;&#125; have been deleted&quot;</span>, filename);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Prepares the batch insert parameters for adding embeddings and text segments</span></span><br><span class="line"><span class="comment">     * to the database.</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> embeddings   The list of embeddings to be added.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> textSegments The list of text segments associated with each embedding.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> A list of MapSqlParameterSource objects for batch insertion.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;MapSqlParameterSource&gt; <span class="title function_">prepareBatchInsertParams</span><span class="params">(List&lt;Embedding&gt; embeddings,</span></span><br><span class="line"><span class="params">            List&lt;TextSegment&gt; textSegments)</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;Preparing batch insert parameters for embeddings and text segments&quot;</span>);</span><br><span class="line">        List&lt;MapSqlParameterSource&gt; paramsList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; embeddings.size(); ++i) &#123;</span><br><span class="line">            <span class="type">Embedding</span> <span class="variable">embedding</span> <span class="operator">=</span> embeddings.get(i);</span><br><span class="line">            <span class="type">TextSegment</span> <span class="variable">textSegment</span> <span class="operator">=</span> textSegments.get(i);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">MapSqlParameterSource</span> <span class="variable">params</span> <span class="operator">=</span> createSqlParameterSource(</span><br><span class="line">                        UUID.randomUUID().toString(),</span><br><span class="line">                        <span class="built_in">this</span>.datasetIds.get(<span class="number">0</span>),</span><br><span class="line">                        embedding,</span><br><span class="line">                        textSegment);</span><br><span class="line">                paramsList.add(params);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">                log.error(<span class="string">&quot;Error processing JSON&quot;</span>, e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> paramsList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Creates and initializes a MapSqlParameterSource object with parameters for</span></span><br><span class="line"><span class="comment">     * SQL operations.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id          The unique identifier for the embedding.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> datasetId   The identifier of the dataset.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> embedding   The embedding object to be stored in the database.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> textSegment The text segment associated with the embedding.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> A MapSqlParameterSource object populated with the required</span></span><br><span class="line"><span class="comment">     *         parameters.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> JsonProcessingException If an error occurs during JSON serialization.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> MapSqlParameterSource <span class="title function_">createSqlParameterSource</span><span class="params">(String id, String datasetId, Embedding embedding,</span></span><br><span class="line"><span class="params">            TextSegment textSegment)</span> <span class="keyword">throws</span> JsonProcessingException &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;Creating SQL parameter source for embedding ID: &#123;&#125;&quot;</span>, id);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Convert metadata to JSON string</span></span><br><span class="line">        Map&lt;String, String&gt; metadataMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(textSegment.metadata().asMap());</span><br><span class="line">        <span class="type">String</span> <span class="variable">metadataJson</span> <span class="operator">=</span> <span class="built_in">this</span>.objectMapper.writeValueAsString(metadataMap);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Create and populate parameters for SQL operation</span></span><br><span class="line">        <span class="type">MapSqlParameterSource</span> <span class="variable">params</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MapSqlParameterSource</span>()</span><br><span class="line">                .addValue(<span class="string">&quot;id&quot;</span>, id)</span><br><span class="line">                .addValue(<span class="string">&quot;datasetId&quot;</span>, datasetId)</span><br><span class="line">                .addValue(<span class="string">&quot;fileName&quot;</span>, metadataMap.get(<span class="string">&quot;file_name&quot;</span>))</span><br><span class="line">                .addValue(<span class="string">&quot;embeddingVector&quot;</span>, <span class="keyword">new</span> <span class="title class_">PGvector</span>(embedding.vector()))</span><br><span class="line">                .addValue(<span class="string">&quot;documentText&quot;</span>, textSegment.text())</span><br><span class="line">                .addValue(<span class="string">&quot;metadata&quot;</span>, metadataJson)</span><br><span class="line">                .addValue(<span class="string">&quot;versionCount&quot;</span>, <span class="number">1</span>)</span><br><span class="line">                .addValue(<span class="string">&quot;createdBy&quot;</span>, <span class="string">&quot;createdBy&quot;</span>) <span class="comment">// Consider using a dynamic value</span></span><br><span class="line">                .addValue(<span class="string">&quot;creationTimestamp&quot;</span>, LocalDateTime.now())</span><br><span class="line">                .addValue(<span class="string">&quot;modifiedBy&quot;</span>, <span class="string">&quot;modifiedBy&quot;</span>) <span class="comment">// Consider using a dynamic value</span></span><br><span class="line">                .addValue(<span class="string">&quot;modificationTimestamp&quot;</span>, LocalDateTime.now());</span><br><span class="line"></span><br><span class="line">        log.debug(<span class="string">&quot;SQL parameter source created for embedding ID: &#123;&#125;&quot;</span>, id);</span><br><span class="line">        <span class="keyword">return</span> params;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">hasSingleDatasetIdentifier</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.datasetIds.size() == <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This code serves as a detailed guide for developers looking to implement similar functionalities in their Java applications.</p>
<h2 id="Leveraging-Liquibase-for-Database-Version-Control"><a href="#Leveraging-Liquibase-for-Database-Version-Control" class="headerlink" title="Leveraging Liquibase for Database Version Control"></a>Leveraging Liquibase for Database Version Control</h2><p>Liquibase plays a crucial role in managing database schema changes and versioning in a Spring Boot application. It ensures a systematic approach to database migrations, making it easier to track and apply schema changes across different environments and versions.</p>
<p>Through the provided YAML configurations, Liquibase enables specific schema operations like enabling vector extensions (<code>001-enable-extension.yaml</code>) and initializing database schema (<code>002-schema-init.yaml</code>). These changes are managed and tracked, ensuring consistency and ease of maintenance.</p>
<p>In conclusion, Liquibase’s integration into a Spring Boot project, illustrated by these practical examples, demonstrates its efficiency in managing database schemas, making it an invaluable tool for developers in maintaining and evolving their database structures.</p>
<p>The integration of Langchain4j, PostgreSQL, Liquibase, and Spring Boot demonstrates a powerful combination for handling vector data in Java applications. This approach offers robust data management, efficient schema version control, and streamlined embedding operations. By leveraging these technologies, developers can manage complex data types more effectively, ensure database consistency across versions, and enhance overall application performance and scalability. This integration is particularly beneficial for data-intensive applications requiring sophisticated handling of vector data and database management.</p>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>Sam Zhu
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://blog.samzhu.dev/2023/12/19/Integrating-Vector-Data-with-Langchain4j-PostgreSQL-and-Liquibase-in-Spring-Boot/" title="Integrating Vector Data with Langchain4j PostgreSQL and Liquibase in Spring Boot">https://blog.samzhu.dev/2023/12/19/Integrating-Vector-Data-with-Langchain4j-PostgreSQL-and-Liquibase-in-Spring-Boot/</a>
  </li>
  <li class="post-copyright-license">
      <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/en" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Spring/" rel="tag"># Spring</a>
              <a href="/tags/Langchain4j/" rel="tag"># Langchain4j</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/11/21/Streamline-Your-Messaging-Cross-Platform-Integration-Made-Easy-with-Spring-Cloud-Stream/" rel="prev" title="Streamline Your Messaging: Cross-Platform Integration Made Easy with Spring Cloud Stream">
                  <i class="fa fa-angle-left"></i> Streamline Your Messaging: Cross-Platform Integration Made Easy with Spring Cloud Stream
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/12/25/Integrating-Google-Gemini-with-langchain4j/" rel="next" title="Integrating Google Gemini with langchain4j">
                  Integrating Google Gemini with langchain4j <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Sam Zhu</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/samzhu" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.3.0/mermaid.min.js","integrity":"sha256-9y71g5Lz/KLsHjB8uXwnkuWDtAMDSzD/HdIbqhJfTAI="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>





  





</body>
</html>
